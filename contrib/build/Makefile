# generated by libdvbcsa.sh

MAKEFLAGS = -rR --no-print-directory

OUT = libdvbcsa.so.1.1.0
LNK = libdvbcsa.so
ALIB = libdvbcsa.a

LPATH = /usr/lib
IPATH = /usr/include/dvbcsa

CC = gcc
LD = gcc
AR = ar

CFLAGS = -O3 -fomit-frame-pointer -funroll-loops -fPIC
LDFLAGS = -shared

OBJS = src/dvbcsa_key.o src/dvbcsa_block.o src/dvbcsa_algo.o src/dvbcsa_stream.o
BSOBJS = src/dvbcsa_bs_algo.o src/dvbcsa_bs_block.o src/dvbcsa_bs_key.o src/dvbcsa_bs_stream.o   src/dvbcsa_bs_transpose.o src/dvbcsa_bs_transpose64.o

.PHONY: all clean install

all: $(OUT) $(ALIB)

clean:
	@echo "CLEAN"
	@rm -f $(OUT) $(ALIB) $(OBJS) $(BSOBJS) Makefile src/config.h

$(OUT): $(OBJS) $(BSOBJS)
	@echo "BUILD: $@"
	@$(LD) $(LDFLAGS) $^ -o $@

$(ALIB): $(OBJS) $(BSOBJS)
	@echo "BUILD: $@"
	@$(AR) cru $@ $^

%.o: %.c
	@echo "   CC: $@"
	@$(CC) $(CFLAGS) -c $< -o $@

install: $(OUT)
	@echo "INSTALL: $(LPATH)/$(OUT)"
	@cp $(OUT) $(LPATH)/$(OUT)
	@echo "INSTALL: $(LPATH)/$(LNK)"
	@ln -nfs $(OUT) $(LPATH)/$(LNK)
	@echo "INSTALL: $(IPATH)/dvbcsa.h"
	@mkdir -p $(IPATH)
	@cp src/dvbcsa/dvbcsa.h $(IPATH)/dvbcsa.h

